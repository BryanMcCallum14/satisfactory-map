import * as React from "react";
import * as L from "leaflet";
import { Popup, Marker } from "react-leaflet";
import { Artifact } from "../../data/markers";
import { IconSizeContext } from "../../InteractiveMap";

type Props = {
  marker: Artifact;
};

export const ArtifactMarker: React.FunctionComponent<Props> = props => {
  const { marker } = props;
  const { iconSize } = React.useContext(IconSizeContext);

  const width = (marker.type === "somer" ? 28 : 40) * iconSize;
  const height = (marker.type === "somer" ? 73 : 67) * iconSize;

  return (
    <Marker
      position={[marker.y || 0, marker.x || 0]}
      icon={L.divIcon({
        html: marker.type === "somer" ? somersloopSvg() : mercerSphereSvg(),
        iconSize: [width, height],
        iconAnchor: [width / 2, height],
        popupAnchor: [0, height / -2],
        className: `artifact_marker artifact_${marker.type}${
          marker.obstructed ? " marker_obstructed" : ""
        }`
      })}
    >
      <Popup>
        <p style={{ textAlign: "center" }}>
          <b>{marker.type === "somer" ? "Somersloop" : "Mercer Sphere"}</b>
        </p>
        <ul style={{ margin: 0, padding: 0, listStyle: "none" }}>
          <li>X: {marker.x}</li>
          <li>Y: {marker.y}</li>
          <li>Z: {marker.z}</li>
        </ul>
        <p style={{ textAlign: "center" }}>
          <b>Informations</b>
        </p>
        <ul style={{ margin: 0, padding: 0, listStyle: "none" }}>
          <li>ID: {marker.originId}</li>
          <li>Obstructed: {marker.obstructed ? "true" : "false"}</li>
        </ul>
      </Popup>
    </Marker>
  );
};

const somersloopSvg = () => {
  return `
    <svg viewBox="0 0 28 73" xmlns="http://www.w3.org/2000/svg">
      <g fill-rule="nonzero" fill="none">
        <path fill="#999" d="M17.3 7.3L10 9.4l-3.6-2 7.2-4.2z" />
        <path fill="#666" d="M13.7 28l-1.8 13.5-3.6 2-3.6-9.2z" />
        <path fill="#999" d="M13.7 28l-9 6.3L6.5 30z" />
        <path fill="#666" d="M13.7 28l-7.2 2.1-3.6-12.4 7.2 2z" />
        <path fill="#999" d="M10 9.4v10.4l-7-2.1L6.4 7.4z" />
        <path fill="#333" d="M24.4 17.7l-3.6 6.2h-3.3l3.3-6.2z" />
        <path fill="#666" d="M17.5 24l-3.8-4.2L10 9.4l7.2-2z" />
        <path fill="#999" d="M20.8 17.7l-3.3 6.2-.2-16.6z" />
        <path
          fill="#666"
          d="M24.4 17.7h-3.6L17.3 7.4h3.5zM20.8 7.3h-3.5l-3.6-4zM24.4 28H13.7l3.8-4h3.3z"
        />
        <path
          fill="#333"
          d="M24.4 28l-3.6 8.3-9 5.2 1.9-13.4zM17.5 24l-3.8 4-3.6-8.2h3.6zM13.7 19.8H10V9.4z"
        />
        <path
          fill="#8F1E1E"
          style="mix-blend-mode:overlay"
          d="M24.4 17.7L20.8 7.4l-7.1-4.2-7.2 4.1-3.6 10.4 3.6 12.4-1.8 4.2 3.6 9.3 3.6-2 9-5.3 3.5-8.2-3.6-4.2z"
        />
        <path
          d="M23 38.3l4.6-10.7-3.4-4 3.3-5.6L23 5.5 13.7 0 4.2 5.5 0 17.6 3.5 30l-1.8 4.3L7 47.6l6-3.4v24.1a2 2 0 1 0 2 0V43l8.1-4.7zm-20.1-4l1.6-4 .2-.3-.1-.4-3.5-12 4-11.4 8.6-5 8.5 5 4 11.7-3 5.1-.3.7.5.6 3 3.4-4.2 9.8L7.4 46 3 34.2z"
          fill="#9A504E"
        />
      </g>
    </svg>
  `;
};

export const mercerSphereSvg = () => {
  return `
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 66.3">
    <g fill-rule="nonzero" fill="none">
      <path d="M36.6 19.8l-1.7.1a10.8 10.8 0 0 0-1.3.1 7.7 7.7 0 0 0-1.1.2 4.3 4.3 0 0 0-.6.2 1 1 0 0 0-.4.3 4.8 4.8 0 0 0-.5 1 1.3 1.3 0 0 1-.8.7 1.4 1.4 0 0 1-.6 0 2.8 2.8 0 0 1-.8-.3 5 5 0 0 1-.4-.4l-.4-.3-.9-.8c-.5-.6-1-1-1.2-1a.9.9 0 0 0-.8.5 5 5 0 0 0-.6 1.3l-.6 1.5a2.4 2.4 0 0 1-.8 1 1.2 1.2 0 0 1-1 0 2.8 2.8 0 0 1-1.1-.6 8.4 8.4 0 0 1-1-1.5 21.1 21.1 0 0 0-1.6-2.7 1 1 0 0 0-.7-.4.5.5 0 0 0-.4.2 2 2 0 0 0-.2.3l-.3.4-.7 1.1-.7 1.2-.4.6-.2.3h-.1l-.1.2a2.8 2.8 0 0 1-.7.6 1.1 1.1 0 0 1-.6.2 1 1 0 0 1-.5-.1 2 2 0 0 1-.7-1.1l-.5-1.5a1.5 1.5 0 0 0-.6-.9 1.4 1.4 0 0 0-1 0c-.4 0-1 .2-1.4.4a4.8 4.8 0 0 1-1.5.2 8 8 0 0 1-1.3 0 10.1 10.1 0 0 1-1.2-.3 6.7 6.7 0 0 1-1.1-.6 16.6 16.6 0 0 1 33.1 0z" fill="#999"/>
      <path d="M36.4 22.4a16.6 16.6 0 0 1-33-1.4v-.8a9.6 9.6 0 0 1 .6 1l.5 1.2a12.3 12.3 0 0 1 1 2.9 9.5 9.5 0 0 0 .5 1.6 2.2 2.2 0 0 0 1 1 2.2 2.2 0 0 0 1.4.2 11.1 11.1 0 0 0 1.6-.5c1.1-.4 2-.4 2.5.5a3.7 3.7 0 0 1 .4 1v.2l.2.4.1.7.4 1.5a9 9 0 0 0 .5 1.4c.7 1.6 1.8 1.4 2.8 1.1a5.4 5.4 0 0 0 1.6-1L20 32a8.1 8.1 0 0 1 2.5-2.4 2.6 2.6 0 0 1 2.7.4c.6.4 1.1.8 1.7 1a4.3 4.3 0 0 0 .4.3l.4.2a3.3 3.3 0 0 0 .8.2 2.2 2.2 0 0 0 1.5-.3 1.7 1.7 0 0 0 .5-.6 3.6 3.6 0 0 0 .4-1l.2-1.4v-.6l.1-.5a3.4 3.4 0 0 1 .3-1 2 2 0 0 1 .4-.5 1.9 1.9 0 0 1 1.2-.4 4.8 4.8 0 0 0 1.4-.2 1.8 1.8 0 0 0 .6-.3 4 4 0 0 0 .4-.5l.3-.6a6 6 0 0 0 .4-.6l.2-.7z" fill="#666"/>
      <path fill="#333" d="M36.6 20v1l-.2 1.4-.2.7a6 6 0 0 1-.4.6l-.3.6a4 4 0 0 1-.4.5 1.8 1.8 0 0 1-.6.3 4.8 4.8 0 0 1-1.4.2 1.9 1.9 0 0 0-1.2.4 2 2 0 0 0-.4.6 3.4 3.4 0 0 0-.3.8v.6l-.1.6-.2 1.3a3.6 3.6 0 0 1-.4 1 1.7 1.7 0 0 1-.5.7 2.2 2.2 0 0 1-1.4.3 3.3 3.3 0 0 1-.8-.2l-.5-.2a4.3 4.3 0 0 1-.4-.2l-1.6-1a2.6 2.6 0 0 0-2.7-.5A8.1 8.1 0 0 0 20 32l-1.5 1.5a5.4 5.4 0 0 1-1.5 1c-1 .3-2.2.5-3-1.1a9 9 0 0 1-.4-1.4l-.3-1.5-.2-.7-.1-.3V29a3.7 3.7 0 0 0-.5-1c-.6-.9-1.4-.8-2.5-.4a11.1 11.1 0 0 1-1.7.5A2.2 2.2 0 0 1 7 28a2.2 2.2 0 0 1-1-1 9.5 9.5 0 0 1-.5-1.7 12.3 12.3 0 0 0-1-2.9l-.5-1.2a9.6 9.6 0 0 0-.5-1 1 1 0 0 1 0-.2.8.8 0 0 1 0-.1 6.7 6.7 0 0 0 1.1.6 10.1 10.1 0 0 0 1.2.3H7a4.8 4.8 0 0 0 1.5-.2c.5-.1 1-.4 1.4-.4a1.4 1.4 0 0 1 1 0 1.5 1.5 0 0 1 .6 1l.5 1.4a2 2 0 0 0 .6 1 1 1 0 0 0 .6.2 1.1 1.1 0 0 0 .6-.1 2.8 2.8 0 0 0 .7-.7l.2-.2.2-.3c0-.2.2-.3.3-.5l.8-1.3.7-1 .2-.5a2 2 0 0 1 .3-.3.5.5 0 0 1 .4-.2 1 1 0 0 1 .7.4A21.1 21.1 0 0 1 20 22a8.4 8.4 0 0 0 1 1.4 2.8 2.8 0 0 0 1 .7 1.2 1.2 0 0 0 1-.1 2.4 2.4 0 0 0 .8-1l.7-1.5A5 5 0 0 1 25 20a.9.9 0 0 1 .8-.4c.3 0 .7.3 1.2.9l1 .8.3.4a5 5 0 0 0 .5.3 2.8 2.8 0 0 0 .7.4 1.4 1.4 0 0 0 .6 0 1.3 1.3 0 0 0 .8-.8 4.8 4.8 0 0 1 .6-1 1 1 0 0 1 .4-.3 4.3 4.3 0 0 1 .5-.1 7.7 7.7 0 0 1 1.2-.3 10.8 10.8 0 0 1 1.3-.1l1.7-.1a1.1 1.1 0 0 1 0 .2z"/>
      <path fill="#333" d="M36.6 20v1l-.2 1.4-.2.7a6 6 0 0 1-.4.6l-.3.6a4 4 0 0 1-.4.5 1.8 1.8 0 0 1-.6.3 4.8 4.8 0 0 1-1.4.2 1.9 1.9 0 0 0-1.2.4 2 2 0 0 0-.4.6 3.4 3.4 0 0 0-.3.8v.6l-.1.6-.2 1.3a3.6 3.6 0 0 1-.4 1 1.7 1.7 0 0 1-.5.7 2.2 2.2 0 0 1-1.4.3 3.3 3.3 0 0 1-.8-.2l-.5-.2a4.3 4.3 0 0 1-.4-.2l-1.6-1a2.6 2.6 0 0 0-2.7-.5A8.1 8.1 0 0 0 20 32l-1.5 1.5a5.4 5.4 0 0 1-1.5 1c-1 .3-2.2.5-3-1.1a9 9 0 0 1-.4-1.4l-.3-1.5-.2-.7-.1-.3V29a3.7 3.7 0 0 0-.5-1c-.6-.9-1.4-.8-2.5-.4a11.1 11.1 0 0 1-1.7.5A2.2 2.2 0 0 1 7 28a2.2 2.2 0 0 1-1-1 9.5 9.5 0 0 1-.5-1.7 12.3 12.3 0 0 0-1-2.9l-.5-1.2a9.6 9.6 0 0 0-.5-1 1 1 0 0 1 0-.2.8.8 0 0 1 0-.1 6.7 6.7 0 0 0 1.1.6 10.1 10.1 0 0 0 1.2.3H7a4.8 4.8 0 0 0 1.5-.2c.5-.1 1-.4 1.4-.4a1.4 1.4 0 0 1 1 0 1.5 1.5 0 0 1 .6 1l.5 1.4a2 2 0 0 0 .6 1 1 1 0 0 0 .6.2 1.1 1.1 0 0 0 .6-.1 2.8 2.8 0 0 0 .7-.7l.2-.2.2-.3c0-.2.2-.3.3-.5l.8-1.3.7-1 .2-.5a2 2 0 0 1 .3-.3.5.5 0 0 1 .4-.2 1 1 0 0 1 .7.4A21.1 21.1 0 0 1 20 22a8.4 8.4 0 0 0 1 1.4 2.8 2.8 0 0 0 1 .7 1.2 1.2 0 0 0 1-.1 2.4 2.4 0 0 0 .8-1l.7-1.5A5 5 0 0 1 25 20a.9.9 0 0 1 .8-.4c.3 0 .7.3 1.2.9l1 .8.3.4a5 5 0 0 0 .5.3 2.8 2.8 0 0 0 .7.4 1.4 1.4 0 0 0 .6 0 1.3 1.3 0 0 0 .8-.8 4.8 4.8 0 0 1 .6-1 1 1 0 0 1 .4-.3 4.3 4.3 0 0 1 .5-.1 7.7 7.7 0 0 1 1.2-.3 10.8 10.8 0 0 1 1.3-.1l1.7-.1a1.1 1.1 0 0 1 0 .2z"/>
      <path d="M36.6 20v1l-.2 1.4-.2.7a6 6 0 0 1-.4.6l-.3.6a4 4 0 0 1-.4.5 1.8 1.8 0 0 1-.6.3 4.8 4.8 0 0 1-1.4.2 1.9 1.9 0 0 0-1.2.4 2 2 0 0 0-.4.6 3.4 3.4 0 0 0-.3.8v.6l-.1.6-.2 1.3a3.6 3.6 0 0 1-.4 1 1.7 1.7 0 0 1-.5.7 2.2 2.2 0 0 1-1.4.3 3.3 3.3 0 0 1-.8-.2l-.5-.2a4.3 4.3 0 0 1-.4-.2l-1.6-1a2.6 2.6 0 0 0-2.7-.5A8.1 8.1 0 0 0 20 32l-1.5 1.5a5.4 5.4 0 0 1-1.5 1c-1 .3-2.2.5-3-1.1a9 9 0 0 1-.4-1.4l-.3-1.5-.2-.7-.1-.3V29a3.7 3.7 0 0 0-.5-1c-.6-.9-1.4-.8-2.5-.4a11.1 11.1 0 0 1-1.7.5A2.2 2.2 0 0 1 7 28a2.2 2.2 0 0 1-1-1 9.5 9.5 0 0 1-.5-1.7 12.3 12.3 0 0 0-1-2.9l-.5-1.2a9.6 9.6 0 0 0-.5-1 1 1 0 0 1 0-.2.8.8 0 0 1 0-.1 6.7 6.7 0 0 0 1.1.6 10.1 10.1 0 0 0 1.2.3H7a4.8 4.8 0 0 0 1.5-.2c.5-.1 1-.4 1.4-.4a1.4 1.4 0 0 1 1 0 1.5 1.5 0 0 1 .6 1l.5 1.4a2 2 0 0 0 .6 1 1 1 0 0 0 .6.2 1.1 1.1 0 0 0 .6-.1 2.8 2.8 0 0 0 .7-.7l.2-.2.2-.3c0-.2.2-.3.3-.5l.8-1.3.7-1 .2-.5a2 2 0 0 1 .3-.3.5.5 0 0 1 .4-.2 1 1 0 0 1 .7.4A21.1 21.1 0 0 1 20 22a8.4 8.4 0 0 0 1 1.4 2.8 2.8 0 0 0 1 .7 1.2 1.2 0 0 0 1-.1 2.4 2.4 0 0 0 .8-1l.7-1.5A5 5 0 0 1 25 20a.9.9 0 0 1 .8-.4c.3 0 .7.3 1.2.9l1 .8.3.4a5 5 0 0 0 .5.3 2.8 2.8 0 0 0 .7.4 1.4 1.4 0 0 0 .6 0 1.3 1.3 0 0 0 .8-.8 4.8 4.8 0 0 1 .6-1 1 1 0 0 1 .4-.3 4.3 4.3 0 0 1 .5-.1 7.7 7.7 0 0 1 1.2-.3 10.8 10.8 0 0 1 1.3-.1l1.7-.1a1.1 1.1 0 0 1 0 .2z" fill="#5a148c"/>
      <path d="M40 19.7a20 20 0 0 0-40 0v1.5A20 20 0 0 0 19 40v22.6a2 2 0 0 0-1 1.7 2 2 0 0 0 4 0 2 2 0 0 0-1-1.7V40a20 20 0 0 0 18.8-17l.2-1.8V20zm-1.4 1.4l-.2 1.7a18.6 18.6 0 0 1-37-1.7v-1.3a18.6 18.6 0 0 1 37.3 0v.2l-.1 1.1z" fill="#b76eff"/>
      <path d="M36.6 20v1l-.2 1.4a16.6 16.6 0 0 1-5.7 10.3A17.5 17.5 0 0 0 9.7 7a16.6 16.6 0 0 1 26.9 12.8 1.3 1.3 0 0 1 0 .2z" opacity=".5" fill="#333"/>
    </g>
  </svg>
  `;
};
