import * as React from "react";
import * as L from "leaflet";
import { Popup, Marker } from "react-leaflet";
import { Artifact } from "../../data/markers";
import { IconSizeContext } from "../../InteractiveMap";

// @ts-ignore
import somerIcon from "./somer.png";
// @ts-ignore
import mercerIcon from "./mercer.png";

type Props = {
  marker: Artifact;
};

export const ArtifactMarker: React.FunctionComponent<Props> = props => {
  const { marker } = props;
  const { iconSize } = React.useContext(IconSizeContext);

  const icons = {
    somer: somerIcon,
    mercer: mercerIcon
  };

  const width = (marker.type === "somer" ? 28 : 40) * iconSize;
  const height = (marker.type === "somer" ? 73 : 68) * iconSize;

  return (
    <Marker
      position={[marker.y || 0, marker.x || 0]}
      icon={L.divIcon({
        html: marker.type === "somer" ? somersloopSvg() : mercerSphereSvg(),
        iconSize: [width, height],
        iconAnchor: [width / 2, height],
        popupAnchor: [0, height / -2],
        className: `artifact_marker artifact_${marker.type}${
          marker.obstructed ? " marker_obstructed" : ""
        }`
      })}
    >
      <Popup>
        <p style={{ textAlign: "center" }}>
          <b>{marker.type === "somer" ? "Somersloop" : "Mercer Sphere"}</b>
        </p>
        <ul style={{ margin: 0, padding: 0, listStyle: "none" }}>
          <li>X: {marker.x}</li>
          <li>Y: {marker.y}</li>
          <li>Z: {marker.z}</li>
        </ul>
        <p style={{ textAlign: "center" }}>
          <b>Informations</b>
        </p>
        <ul style={{ margin: 0, padding: 0, listStyle: "none" }}>
          <li>ID: {marker.originId}</li>
          <li>Obstructed: {marker.obstructed ? "true" : "false"}</li>
        </ul>
      </Popup>
    </Marker>
  );
};

const somersloopSvg = () => {
  return `
    <svg viewBox="0 0 28 73" xmlns="http://www.w3.org/2000/svg">
      <g fill-rule="nonzero" fill="none">
        <path fill="#999" d="M17.3 7.3L10 9.4l-3.6-2 7.2-4.2z" />
        <path fill="#666" d="M13.7 28l-1.8 13.5-3.6 2-3.6-9.2z" />
        <path fill="#999" d="M13.7 28l-9 6.3L6.5 30z" />
        <path fill="#666" d="M13.7 28l-7.2 2.1-3.6-12.4 7.2 2z" />
        <path fill="#999" d="M10 9.4v10.4l-7-2.1L6.4 7.4z" />
        <path fill="#333" d="M24.4 17.7l-3.6 6.2h-3.3l3.3-6.2z" />
        <path fill="#666" d="M17.5 24l-3.8-4.2L10 9.4l7.2-2z" />
        <path fill="#999" d="M20.8 17.7l-3.3 6.2-.2-16.6z" />
        <path
          fill="#666"
          d="M24.4 17.7h-3.6L17.3 7.4h3.5zM20.8 7.3h-3.5l-3.6-4zM24.4 28H13.7l3.8-4h3.3z"
        />
        <path
          fill="#333"
          d="M24.4 28l-3.6 8.3-9 5.2 1.9-13.4zM17.5 24l-3.8 4-3.6-8.2h3.6zM13.7 19.8H10V9.4z"
        />
        <path
          fill="#8F1E1E"
          style="mix-blend-mode:overlay"
          d="M24.4 17.7L20.8 7.4l-7.1-4.2-7.2 4.1-3.6 10.4 3.6 12.4-1.8 4.2 3.6 9.3 3.6-2 9-5.3 3.5-8.2-3.6-4.2z"
        />
        <path
          d="M23 38.3l4.6-10.7-3.4-4 3.3-5.6L23 5.5 13.7 0 4.2 5.5 0 17.6 3.5 30l-1.8 4.3L7 47.6l6-3.4v24.1a2 2 0 1 0 2 0V43l8.1-4.7zm-20.1-4l1.6-4 .2-.3-.1-.4-3.5-12 4-11.4 8.6-5 8.5 5 4 11.7-3 5.1-.3.7.5.6 3 3.4-4.2 9.8L7.4 46 3 34.2z"
          fill="#9A504E"
        />
      </g>
    </svg>
  `;
};

export const mercerSphereSvg = () => {
  return `
    <svg viewBox="0 0 40 68" xmlns="http://www.w3.org/2000/svg">
      <g fill-rule="nonzero" fill="none">
        <path d="M36.6 20.8l-1.7.1a10.8 10.8 0 0 0-3 .5 1 1 0 0 0-.4.3l-.5 1c-.2.4-.5.6-.8.7h-.6c-.3 0-.5-.2-.8-.3a5 5 0 0 1-.4-.4l-.4-.3-.9-.8c-.5-.6-1-1-1.2-1-.3 0-.6.3-.8.5a5 5 0 0 0-.6 1.3l-.6 1.5c-.2.4-.4.7-.8 1-.3.2-.7.2-1 0-.4 0-.8-.3-1.1-.6l-1-1.4c-.4-1-1-2-1.6-2.8a1 1 0 0 0-.7-.5l-.4.3a2 2 0 0 0-.2.3l-.3.4-.7 1.1-.7 1.2-.4.6-.2.3h-.1l-.1.2-.7.6-.6.2a1 1 0 0 1-.5-.2 2 2 0 0 1-.7-1l-.4-1.5c-.1-.4-.4-.7-.7-.9-.3-.1-.6-.2-1 0-.4 0-1 .2-1.4.4l-1.5.2a10.1 10.1 0 0 1-2.5-.4c-.4-.1-.8-.3-1.1-.6a16.6 16.6 0 0 1 33.1 0z" fill="#999"/>
        <path d="M36.4 23.4a16.6 16.6 0 0 1-33-1.4v-.9a9.5 9.5 0 0 1 1 2.3c.5.9.9 1.9 1 2.9.2.5.3 1.1.6 1.6.2.5.5.8 1 1 .4.3 1 .3 1.4.2l1.6-.5c1.1-.4 2-.4 2.5.5l.4 1v.3l.2.3.1.7a27.3 27.3 0 0 0 .9 2.9c.7 1.6 1.8 1.4 2.8 1.1.6-.2 1.1-.5 1.6-1L20 33c.7-1 1.5-1.8 2.6-2.4.9-.4 2-.2 2.6.4.6.4 1.1.8 1.7 1l.4.3.4.2.8.2c.5 0 1 0 1.5-.3l.5-.6.4-1 .2-1.4v-.6l.1-.6c0-.3.2-.6.3-.8l.4-.6c.4-.2.8-.4 1.2-.4.5 0 1 0 1.4-.2l.6-.3.4-.5a6.8 6.8 0 0 0 .9-1.9z" fill="#666"/>
        <path d="M36.6 21v1l-.2 1.4a14.9 14.9 0 0 0-.5 1.3 6.8 6.8 0 0 1-.8 1c-.2.2-.4.4-.6.4-.4.2-.9.2-1.4.2-.4 0-.8.2-1.2.4a2 2 0 0 0-.4.6l-.3.8v.6l-.1.6a17.1 17.1 0 0 1-.6 2.4c0 .2-.3.5-.5.6-.4.3-1 .4-1.4.3l-.8-.2-.5-.2-.4-.2-1.6-1c-.7-.7-1.8-.8-2.7-.5-1 .6-2 1.4-2.6 2.4l-1.5 1.5c-.4.5-1 .8-1.6 1-1 .3-2.1.5-2.8-1.1a49.3 49.3 0 0 1-.8-2.9l-.2-.7-.1-.3V30l-.5-1c-.6-.9-1.4-.9-2.5-.4l-1.7.5c-.5.1-1 .1-1.4-.1-.5-.2-.8-.6-1-1l-.5-1.7a24.2 24.2 0 0 0-2-5.4l1.1.6 1.2.3H7c.5 0 1 0 1.5-.2.5-.1 1-.4 1.4-.4h1c.3.2.6.6.6 1l.5 1.4c0 .4.3.8.7 1 .1.2.3.2.5.2l.6-.1.7-.7.2-.2.2-.3c0-.2.2-.3.3-.5l.8-1.3.7-1 .3-.5.2-.3.4-.2c.3 0 .6.2.7.4.7.9 1.2 1.8 1.7 2.8l1 1.4 1 .7c.3.1.7 0 1-.1.4-.3.6-.6.8-1l.7-1.5c0-.5.3-.9.5-1.3.2-.2.5-.4.8-.4.3 0 .7.3 1.3.9l.8.8.5.4.4.3.7.4h.6c.4-.1.7-.4.8-.8l.6-1 .4-.3.5-.1a7.7 7.7 0 0 1 2.5-.4l1.7-.1v.2z" fill="#333"/>
        <path d="M36.6 21v1l-.2 1.4a14.9 14.9 0 0 0-.5 1.3 6.8 6.8 0 0 1-.8 1c-.2.2-.4.4-.6.4-.4.2-.9.2-1.4.2-.4 0-.8.2-1.2.4a2 2 0 0 0-.4.6l-.3.8v.6l-.1.6a17.1 17.1 0 0 1-.6 2.4c0 .2-.3.5-.5.6-.4.3-1 .4-1.4.3l-.8-.2-.5-.2-.4-.2-1.6-1c-.7-.7-1.8-.8-2.7-.5-1 .6-2 1.4-2.6 2.4l-1.5 1.5c-.4.5-1 .8-1.6 1-1 .3-2.1.5-2.8-1.1a49.3 49.3 0 0 1-.8-2.9l-.2-.7-.1-.3V30l-.5-1c-.6-.9-1.4-.9-2.5-.4l-1.7.5c-.5.1-1 .1-1.4-.1-.5-.2-.8-.6-1-1l-.5-1.7a24.2 24.2 0 0 0-2-5.4l1.1.6 1.2.3H7c.5 0 1 0 1.5-.2.5-.1 1-.4 1.4-.4h1c.3.2.6.6.6 1l.5 1.4c0 .4.3.8.7 1 .1.2.3.2.5.2l.6-.1.7-.7.2-.2.2-.3c0-.2.2-.3.3-.5l.8-1.3.7-1 .3-.5.2-.3.4-.2c.3 0 .6.2.7.4.7.9 1.2 1.8 1.7 2.8l1 1.4 1 .7c.3.1.7 0 1-.1.4-.3.6-.6.8-1l.7-1.5c0-.5.3-.9.5-1.3.2-.2.5-.4.8-.4.3 0 .7.3 1.3.9l.8.8.5.4.4.3.7.4h.6c.4-.1.7-.4.8-.8l.6-1 .4-.3.5-.1a7.7 7.7 0 0 1 2.5-.4l1.7-.1v.2z" fill="#333"/>
        <path d="M36.6 21v1l-.2 1.4a14.9 14.9 0 0 0-.5 1.3 6.8 6.8 0 0 1-.8 1c-.2.2-.4.4-.6.4-.4.2-.9.2-1.4.2-.4 0-.8.2-1.2.4a2 2 0 0 0-.4.6l-.3.8v.6l-.1.6a17.1 17.1 0 0 1-.6 2.4c0 .2-.3.5-.5.6-.4.3-1 .4-1.4.3l-.8-.2-.5-.2-.4-.2-1.6-1c-.7-.7-1.8-.8-2.7-.5-1 .6-2 1.4-2.6 2.4l-1.5 1.5c-.4.5-1 .8-1.6 1-1 .3-2.1.5-2.8-1.1a49.3 49.3 0 0 1-.8-2.9l-.2-.7-.1-.3V30l-.5-1c-.6-.9-1.4-.9-2.5-.4l-1.7.5c-.5.1-1 .1-1.4-.1-.5-.2-.8-.6-1-1l-.5-1.7a24.2 24.2 0 0 0-2-5.4l1.1.6 1.2.3H7c.5 0 1 0 1.5-.2.5-.1 1-.4 1.4-.4h1c.3.2.6.6.6 1l.5 1.4c0 .4.3.8.7 1 .1.2.3.2.5.2l.6-.1.7-.7.2-.2.2-.3c0-.2.2-.3.3-.5l.8-1.3.7-1 .3-.5.2-.3.4-.2c.3 0 .6.2.7.4.7.9 1.2 1.8 1.7 2.8l1 1.4 1 .7c.3.1.7 0 1-.1.4-.3.6-.6.8-1l.7-1.5c0-.5.3-.9.5-1.3.2-.2.5-.4.8-.4.3 0 .7.3 1.3.9l.8.8.5.4.4.3.7.4h.6c.4-.1.7-.4.8-.8l.6-1 .4-.3.5-.1a7.7 7.7 0 0 1 2.5-.4l1.7-.1v.2z" fill="#5A148C"/>
        <path d="M40 20.7a20 20 0 1 0-40 0v1.5A20 20 0 0 0 19 41v22.6a2 2 0 1 0 2 0V41a20 20 0 0 0 19-18.8v-1.5zm-1.4 1.4l-.2 1.7a18.6 18.6 0 0 1-37-1.7v-1.3a18.6 18.6 0 0 1 37.3 0v.2l-.1 1.1z" fill="#B76EFF"/>
      </g>
    </svg>
  `;
};
